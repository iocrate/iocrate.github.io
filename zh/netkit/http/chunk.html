<!--?xml version="1.0" encoding="utf-8" ?--><!DOCTYPE html><!--  This file is generated by Nim. --><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA==">
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- Google fonts -->
<link href="https://fonts.googleapis.com/css?family=Lato:400,600,900" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600" rel="stylesheet" type="text/css">

<!-- CSS -->
<title>netkit/http/chunk</title>
<link rel="stylesheet" type="text/css" href="../../nimdoc.out.css">

<script type="text/javascript" src="/dochack.js"></script>

<script type="text/javascript">
function main() {
  var pragmaDots = document.getElementsByClassName("pragmadots");
  for (var i = 0; i < pragmaDots.length; i++) {
    pragmaDots[i].onclick = function(event) {
      // Hide tease
      event.target.parentNode.style.display = "none";
      // Show actual
      event.target.parentNode.nextElementSibling.style.display = "inline";
    }
  }

  const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
  function switchTheme(e) {
      if (e.target.checked) {
          document.documentElement.setAttribute('data-theme', 'dark');
          localStorage.setItem('theme', 'dark');
      } else {
          document.documentElement.setAttribute('data-theme', 'light');
          localStorage.setItem('theme', 'light');
      }
  }

  toggleSwitch.addEventListener('change', switchTheme, false);


  if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    document.documentElement.setAttribute('data-theme', "dark");
    toggleSwitch.checked = true;
  } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', "light");
    toggleSwitch.checked = false;
  } else {
    const currentTheme = localStorage.getItem('theme') ? localStorage.getItem('theme') : null;
    if (currentTheme) {
      document.documentElement.setAttribute('data-theme', currentTheme);

      if (currentTheme === 'dark') {
        toggleSwitch.checked = true;
      }
    }
  }
}
</script>

<style>
    h1 {
      border-bottom: none;
    }
    
    .container h1.title {
      width: 80.0%;
    }
    .container > .row > .columns:first-of-type {
      float: none;
      position: fixed;
      right: 0;
      top: 0;
      width: 18%;
      height: 100%;
      padding-top: 40px;
    }
    .footer {
      width: 80.0%;
    }
    #toc-list {
      height: calc(100% - 169px);
      overflow-y: hidden;
    }
    #toc-list:hover {
      overflow-y: auto;
    }
    #content.columns {
      margin-left: auto;
      margin-left: 1%;
      margin-right: 1%;
    }
  
    pre {
      width: 100%;
      overflow: hidden;
      padding: 0.5em 1em;
    }
    pre:hover {
      overflow: auto;
    }
  
    .pre {
      font-family: Fira Code,Anonymous Pro,Monaco,Menlo,Consolas,Droid Sans Mono,Monospace;
      display: inline-block;
      padding: 0px 0.3em;
      color: #2a6e6b; /*#2a6e6b #4a7e7b*/
      font-weight: bold;
      border-radius: 2px;
      background-color: transparent;
    }

    .r-fragment {
      padding: 0 0 0 30px;
      border-left: 1px solid rgb(216,216,216);
      margin: 40px 0;
    }

    .r-ol {
      padding-left: 1em;
    }

    p {
      margin-top: 20px;
      margin-bottom: 20px;
    }
  </style></head>
<body onload="main()">
<div class="document" id="documentId">
  <div class="container">
    <h1 class="title">netkit/http/chunk</h1>
    <div class="row">
  <div class="three columns">
  <div class="theme-switch-wrapper">
    <label class="theme-switch" for="checkbox">
      <input type="checkbox" id="checkbox">
      <div class="slider round"></div>
    </label>
    &nbsp;&nbsp;&nbsp; <em>Dark Mode</em>
  </div>
  <div id="global-links">
    <ul class="simple">
    </ul>
  </div>
  <div id="searchInputDiv">
    Search: <input type="text" id="searchInput" onkeyup="search()">
  </div>
  <div>
    Group by:
    <select onchange="groupBy(this.value)">
      <option value="section">Section</option>
      <option value="type">Type</option>
    </select>
  </div>
  <ul class="simple simple-toc" id="toc-list">
<li><a class="reference" id="overview_toc" href="#overview">Overview</a></li>
<ul class="simple"><li><a class="reference" id="overview-format_toc" href="#overview-format">Format</a></li>
<li><a class="reference" id="overview-example_toc" href="#overview-example">Example</a></li>
<li><a class="reference" id="overview-about-backslashn-and-backslashl_toc" href="#overview-about-backslashn-and-backslashl">About \n and \L</a></li>
</ul><li><a class="reference" id="usage_toc" href="#usage">Usage</a></li>
<ul class="simple"><li><a class="reference" id="usage-encoding_toc" href="#usage-encoding">Encoding</a></li>
<li><a class="reference" id="usage-encoding-with-pointer-buffer_toc" href="#usage-encoding-with-pointer-buffer">Encoding with pointer buffer</a></li>
<li><a class="reference" id="usage-decoding_toc" href="#usage-decoding">Decoding</a></li>
</ul><li>
  <a class="reference reference-toplevel" href="#6" id="56">Imports</a>
  <ul class="simple simple-toc-section">
    
  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#7" id="57">Types</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#ChunkHeader" title="ChunkHeader = object
  size*: Natural
  extensions*: string"><wbr>Chunk<wbr>Header<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#ChunkExtension" title="ChunkExtension = tuple[name: string, value: string]"><wbr>Chunk<wbr>Extension<span class="attachedType"></span></a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#12" id="62">Procs</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#parseChunkHeader%2Cstring" title="parseChunkHeader(s: string): ChunkHeader"><wbr>parse<wbr>Chunk<wbr>Header<span class="attachedType">ChunkHeader</span></a></li>
  <li><a class="reference" href="#parseChunkExtensions%2Cstring" title="parseChunkExtensions(s: string): seq[ChunkExtension]"><wbr>parse<wbr>Chunk<wbr>Extensions<span class="attachedType">ChunkExtension</span></a></li>
  <li><a class="reference" href="#parseChunkTrailers%2CopenArray%5Bstring%5D" title="parseChunkTrailers(ts: openArray[string]): HeaderFields"><wbr>parse<wbr>Chunk<wbr>Trailers<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#encodeChunk%2Cpointer%2Cpointer%2CNatural" title="encodeChunk(source: pointer; dest: pointer; size: Natural): Natural"><wbr>encode<wbr>Chunk<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#encodeChunk%2Cpointer%2Cpointer%2CNatural%2Ctype+openArray%5BChunkExtension%5D" title="encodeChunk(source: pointer; dest: pointer; size: Natural;
            extensions = openArray[ChunkExtension]): Natural"><wbr>encode<wbr>Chunk<span class="attachedType">ChunkExtension</span></a></li>
  <li><a class="reference" href="#encodeChunk%2Cstring" title="encodeChunk(source: string): string"><wbr>encode<wbr>Chunk<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#encodeChunk%2Cstring%2CopenArray%5BChunkExtension%5D" title="encodeChunk(source: string; extensions: openArray[ChunkExtension]): string"><wbr>encode<wbr>Chunk<span class="attachedType">ChunkExtension</span></a></li>
  <li><a class="reference" href="#encodeChunkEnd" title="encodeChunkEnd(): string"><wbr>encode<wbr>Chunk<wbr>End<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#encodeChunkEnd%2CHeaderFields" title="encodeChunkEnd(trailers: HeaderFields): string"><wbr>encode<wbr>Chunk<wbr>End<span class="attachedType"></span></a></li>

  </ul>
</li>

</ul>

  </div>
  <div class="nine columns" id="content">
  <div id="tocRoot"></div>
  
  <p class="module-desc">HTTP 1.1 supports chunked encoding, which allows HTTP messages to be broken up into several parts. Chunking is most often used by the server for responses, but clients can also chunk large requests. By adding <tt class="docutils literal"><span class="pre">Transfer-Encoding: chunked</span></tt> to a message header, this message can be sent chunk by chunk. Each data chunk requires to be encoded and decoded when it is sent and received. This module provides tools for dealing with these types of encodings and decodings.
</p><h1><a class="toc-backref" id="overview" href="#overview">Overview</a></h1><div class="r-fragment">
<h2><a class="toc-backref" id="overview-format" href="#overview-format">Format</a></h2><p>If a <tt class="docutils literal"><span class="pre">Transfer-Encoding</span></tt> field with a value of <tt class="docutils literal"><span class="pre">"chunked"</span></tt> is specified in an HTTP message (either a request sent by a client or the response from the server), the body of the message consists of an unspecified number of chunks, a terminating chunk, trailer, and a final CRLF sequence (i.e. carriage return followed by line feed).</p>
<p>Each chunk starts with the number of octets of the data it embeds expressed as a hexadecimal number in ASCII followed by optional parameters (chunk extension) and a terminating CRLF sequence, followed by the chunk data. The chunk is terminated by CRLF.</p>
<p>If chunk extensions are provided, the chunk size is terminated by a semicolon and followed by the parameters, each also delimited by semicolons. Each parameter is encoded as an extension name followed by an optional equal sign and value. These parameters could be used for a running message digest or digital signature, or to indicate an estimated transfer progress, for instance.</p>
<p>The terminating chunk is a regular chunk, with the exception that its length is zero. It is followed by the trailer, which consists of a (possibly empty) sequence of entity header fields. Normally, such header fields would be sent in the message's header; however, it may be more efficient to determine them after processing the entire message entity. In that case, it is useful to send those headers in the trailer.</p>
<p>Header fields that regulate the use of trailers are <tt class="docutils literal"><span class="pre">TE</span></tt> (used in requests), and <tt class="docutils literal"><span class="pre">Trailers</span></tt> (used in responses).</p>
<blockquote><p>See <a class="reference external" href="https://en.wikipedia.org/wiki/Chunked_transfer_encoding">Chunked transfer encoding</a> for more information.</p></blockquote>
</div><div class="r-fragment">
<h2><a class="toc-backref" id="overview-example" href="#overview-example">Example</a></h2><p>Here is an example of a body of a chunked message:</p>
<pre class="listing">5;\r\n                                      # chunk-size and chunk-extensions (empty)
Hello\r\n                                   # data
9; language=en; city=London\r\n             # chunk-size and chunk-extensions
Developer\r\n                               # data
0\r\n                                       # terminating chunk ---------------------
Expires: Wed, 21 Oct 2015 07:28:00 GMT\r\n  # trailer
\r\n                                        # final CRLF-----------------------------</pre></div><div class="r-fragment">
<h2><a class="toc-backref" id="overview-about-backslashn-and-backslashl" href="#overview-about-backslashn-and-backslashl">About \n and \L</a></h2><p>Since <tt class="docutils literal"><span class="pre">\n</span></tt> cannot be represented as a character (but a string) in Nim language, we use <tt class="docutils literal"><span class="pre">'\L'</span></tt> to represent a newline character here.</p>
</div>
<h1><a class="toc-backref" id="usage" href="#usage">Usage</a></h1><div class="r-fragment">
<h2><a class="toc-backref" id="usage-encoding" href="#usage-encoding">Encoding</a></h2><p>To implement a chunked body shown in the above example:</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">netkit</span><span class="Operator">/</span><span class="Identifier">http</span><span class="Operator">/</span><span class="Identifier">chunk</span>
<span class="Keyword">import</span> <span class="Identifier">netkit</span><span class="Operator">/</span><span class="Identifier">http</span><span class="Operator">/</span><span class="Identifier">headerfield</span>

<span class="Identifier">assert</span> <span class="Identifier">encodeChunk</span><span class="Punctuation">(</span><span class="StringLit">"Hello"</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="StringLit">"5;</span><span class="EscapeSequence">\r</span><span class="EscapeSequence">\n</span><span class="EscapeSequence">Hello\r</span><span class="EscapeSequence">\n</span><span class="StringLit">"</span>

<span class="Identifier">assert</span> <span class="Identifier">encodeChunk</span><span class="Punctuation">(</span><span class="StringLit">"Developer"</span><span class="Punctuation">,</span> <span class="Punctuation">{</span>
  <span class="StringLit">"language"</span><span class="Punctuation">:</span> <span class="StringLit">"en"</span><span class="Punctuation">,</span>
  <span class="StringLit">"city"</span><span class="Punctuation">:</span> <span class="StringLit">"London"</span>
<span class="Punctuation">}</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="StringLit">"9; language=en; city=London</span><span class="EscapeSequence">\r</span><span class="EscapeSequence">\n</span><span class="EscapeSequence">Developer\r</span><span class="EscapeSequence">\n</span><span class="StringLit">"</span>

<span class="Identifier">assert</span> <span class="Identifier">encodeChunkEnd</span><span class="Punctuation">(</span><span class="Identifier">initHeaderFields</span><span class="Punctuation">(</span><span class="Punctuation">{</span>
  <span class="StringLit">"Expires"</span><span class="Punctuation">:</span> <span class="StringLit">"Wed, 21 Oct 2015 07:28:00 GMT"</span>
<span class="Punctuation">}</span><span class="Punctuation">)</span><span class="Punctuation">)</span> <span class="Operator">==</span> <span class="StringLit">"0</span><span class="EscapeSequence">\r</span><span class="EscapeSequence">\n</span><span class="EscapeSequence">Expires: Wed, 21 Oct 2015 07:28:00 GMT\r</span><span class="EscapeSequence">\n</span><span class="EscapeSequence">\r</span><span class="EscapeSequence">\n</span><span class="StringLit">"</span></pre><p>This example demonstrates the string version of the encoding procs. However, there is also a more efficient solution.</p>

<h2><a class="toc-backref" id="usage-encoding-with-pointer-buffer" href="#usage-encoding-with-pointer-buffer">Encoding with pointer buffer</a></h2><p>Continuously reads data from a file and then encodes the data:</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">netkit</span><span class="Operator">/</span><span class="Identifier">http</span><span class="Operator">/</span><span class="Identifier">chunk</span>
<span class="Keyword">import</span> <span class="Identifier">netkit</span><span class="Operator">/</span><span class="Identifier">http</span><span class="Operator">/</span><span class="Identifier">headerfield</span>

<span class="Keyword">var</span> <span class="Identifier">source</span><span class="Punctuation">:</span> <span class="Identifier">array</span><span class="Punctuation">[</span><span class="DecNumber">64</span><span class="Punctuation">,</span> <span class="Identifier">byte</span><span class="Punctuation">]</span>
<span class="Keyword">var</span> <span class="Identifier">dest</span><span class="Punctuation">:</span> <span class="Identifier">array</span><span class="Punctuation">[</span><span class="DecNumber">128</span><span class="Punctuation">,</span> <span class="Identifier">byte</span><span class="Punctuation">]</span>

<span class="Comment"># open a large file</span>
<span class="Keyword">var</span> <span class="Identifier">file</span> <span class="Operator">=</span> <span class="Identifier">open</span><span class="Punctuation">(</span><span class="StringLit">"test.blob"</span><span class="Punctuation">)</span>

<span class="Keyword">while</span> <span class="Identifier">true</span><span class="Punctuation">:</span>
  <span class="Keyword">let</span> <span class="Identifier">readLen</span> <span class="Operator">=</span> <span class="Identifier">file</span><span class="Operator">.</span><span class="Identifier">readBuffer</span><span class="Punctuation">(</span><span class="Identifier">source</span><span class="Operator">.</span><span class="Keyword">addr</span><span class="Punctuation">,</span> <span class="DecNumber">64</span><span class="Punctuation">)</span>
  
  <span class="Keyword">if</span> <span class="Identifier">readLen</span> <span class="Operator">&gt;</span> <span class="DecNumber">0</span><span class="Punctuation">:</span>
    <span class="Keyword">let</span> <span class="Identifier">encodeLen</span> <span class="Operator">=</span> <span class="Identifier">encodeChunk</span><span class="Punctuation">(</span><span class="Identifier">source</span><span class="Operator">.</span><span class="Keyword">addr</span><span class="Punctuation">,</span> <span class="Identifier">readLen</span><span class="Punctuation">,</span> <span class="Identifier">dest</span><span class="Operator">.</span><span class="Keyword">addr</span><span class="Punctuation">,</span> <span class="DecNumber">128</span><span class="Punctuation">)</span>
    <span class="Comment"># handle dest, encodeLen ...</span>
  
  <span class="Comment"># read EOF</span>
  <span class="Keyword">if</span> <span class="Identifier">readLen</span> <span class="Operator">&lt;</span> <span class="DecNumber">64</span><span class="Punctuation">:</span>
    <span class="Identifier">echo</span> <span class="Identifier">encodeChunkEnd</span><span class="Punctuation">(</span><span class="Identifier">initHeaderFields</span><span class="Punctuation">(</span><span class="Punctuation">{</span>
      <span class="StringLit">"Expires"</span><span class="Punctuation">:</span> <span class="StringLit">"Wed, 21 Oct 2015 07:28:00 GMT"</span>
    <span class="Punctuation">}</span><span class="Punctuation">)</span><span class="Punctuation">)</span>
    <span class="Keyword">break</span></pre><blockquote><p>Consider using pointer buffer when you are dealing with large amounts of data and are very concerned about memory consumption.</p></blockquote>
</div><div class="r-fragment">
<h2><a class="toc-backref" id="usage-decoding" href="#usage-decoding">Decoding</a></h2><p>To parse a char sequence consisting of chunk-size and chunk-extensions:</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">netkit</span><span class="Operator">/</span><span class="Identifier">http</span><span class="Operator">/</span><span class="Identifier">chunk</span>

<span class="Keyword">let</span> <span class="Identifier">header</span> <span class="Operator">=</span> <span class="Identifier">parseChunkHeader</span><span class="Punctuation">(</span><span class="StringLit">"1A; a1=v1; a2=v2"</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">header</span><span class="Operator">.</span><span class="Identifier">size</span> <span class="Operator">=</span> <span class="DecNumber">26</span>
<span class="Identifier">assert</span> <span class="Identifier">header</span><span class="Operator">.</span><span class="Identifier">extensions</span> <span class="Operator">=</span> <span class="StringLit">"; a1=v1; a2=v2"</span></pre><p>To parse a char sequence associated with chunk-extensions ：</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">netkit</span><span class="Operator">/</span><span class="Identifier">http</span><span class="Operator">/</span><span class="Identifier">chunk</span>

<span class="Keyword">let</span> <span class="Identifier">extensions</span> <span class="Operator">=</span> <span class="Identifier">parseChunkExtensions</span><span class="Punctuation">(</span><span class="StringLit">"; a1=v1; a2=v2"</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">extensions</span><span class="Punctuation">[</span><span class="DecNumber">0</span><span class="Punctuation">]</span><span class="Operator">.</span><span class="Identifier">name</span> <span class="Operator">=</span> <span class="StringLit">"a1"</span>
<span class="Identifier">assert</span> <span class="Identifier">extensions</span><span class="Punctuation">[</span><span class="DecNumber">0</span><span class="Punctuation">]</span><span class="Operator">.</span><span class="Identifier">value</span> <span class="Operator">=</span> <span class="StringLit">"v1"</span>
<span class="Identifier">assert</span> <span class="Identifier">extensions</span><span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">]</span><span class="Operator">.</span><span class="Identifier">name</span> <span class="Operator">=</span> <span class="StringLit">"a2"</span>
<span class="Identifier">assert</span> <span class="Identifier">extensions</span><span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">]</span><span class="Operator">.</span><span class="Identifier">value</span> <span class="Operator">=</span> <span class="StringLit">"v2"</span></pre><p>To parse a set of char sequence associated with tailers：</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">netkit</span><span class="Operator">/</span><span class="Identifier">http</span><span class="Operator">/</span><span class="Identifier">chunk</span>

<span class="Keyword">let</span> <span class="Identifier">tailers</span> <span class="Operator">=</span> <span class="Identifier">parseChunkTrailers</span><span class="Punctuation">(</span><span class="Operator">@</span><span class="Punctuation">[</span><span class="StringLit">"Expires: Wed, 21 Oct 2015 07:28:00 GMT"</span><span class="Punctuation">]</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">tailers</span><span class="Punctuation">[</span><span class="StringLit">"Expires"</span><span class="Punctuation">]</span><span class="Punctuation">[</span><span class="DecNumber">0</span><span class="Punctuation">]</span> <span class="Operator">==</span> <span class="StringLit">"Wed, 21 Oct 2015 07:28:00 GMT"</span></pre></div><p></p>
  <div class="section" id="6">
<h1><a class="toc-backref" href="#6">Imports</a></h1>
<dl class="item">
<a class="reference external" href="../misc.html">../misc</a>, <a class="reference external" href="spec.html">spec</a>, <a class="reference external" href="limits.html">limits</a>, <a class="reference external" href="headerfield.html">headerfield</a>
</dl></div>
<div class="section" id="7">
<h1><a class="toc-backref" href="#7">Types</a></h1>
<dl class="item">
<a id="ChunkHeader"></a>
<dt><pre><a href="chunk.html#ChunkHeader"><span class="Identifier">ChunkHeader</span></a> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">size</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">Natural</span>
  <span class="Identifier">extensions</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">string</span>
</pre></dt>
<dd>

Represents the header of a chunk.
&nbsp;&nbsp;<a href="https://github.com/iocrate/netkit/tree/master/netkit/http/chunk.nim#L180" class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/iocrate/netkit/edit/devel/netkit/http/chunk.nim#L180" class="link-seesrc" target="_blank">Edit</a>

</dd>
<a id="ChunkExtension"></a>
<dt><pre><a href="chunk.html#ChunkExtension"><span class="Identifier">ChunkExtension</span></a> <span class="Other">=</span> <span class="Keyword">tuple</span><span class="Other">[</span><span class="Identifier">name</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">,</span> <span class="Identifier">value</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">]</span></pre></dt>
<dd>

Represents a chunk extension.
&nbsp;&nbsp;<a href="https://github.com/iocrate/netkit/tree/master/netkit/http/chunk.nim#L184" class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/iocrate/netkit/edit/devel/netkit/http/chunk.nim#L184" class="link-seesrc" target="_blank">Edit</a>

</dd>

</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#12">Procs</a></h1>
<dl class="item">
<a id="parseChunkHeader,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#parseChunkHeader%2Cstring"><span class="Identifier">parseChunkHeader</span></a><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <a href="chunk.html#ChunkHeader"><span class="Identifier">ChunkHeader</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ValueError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Converts a string to a <tt class="docutils literal"><span class="pre">ChunkHeader</span></tt>.</p>
<p>Examples:</p>
<pre class="listing"><span class="Identifier">parseChunkHeader</span><span class="Punctuation">(</span><span class="StringLit">"64"</span><span class="Punctuation">)</span> <span class="Comment"># =&gt; (100, "")</span>
<span class="Identifier">parseChunkHeader</span><span class="Punctuation">(</span><span class="StringLit">"64; name=value"</span><span class="Punctuation">)</span> <span class="Comment"># =&gt; (100, "; name=value")</span></pre>
&nbsp;&nbsp;<a href="https://github.com/iocrate/netkit/tree/master/netkit/http/chunk.nim#L188" class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/iocrate/netkit/edit/devel/netkit/http/chunk.nim#L188" class="link-seesrc" target="_blank">Edit</a>

</dd>
<a id="parseChunkExtensions,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#parseChunkExtensions%2Cstring"><span class="Identifier">parseChunkExtensions</span></a><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><a href="chunk.html#ChunkExtension"><span class="Identifier">ChunkExtension</span></a><span class="Other">]</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Converts a string representing extensions to a set of <tt class="docutils literal"><span class="pre">(name, value)</span></tt> pair.</p>
<p>Examples:</p>
<pre class="listing"><span class="Keyword">let</span> <span class="Identifier">extensions</span> <span class="Operator">=</span> <span class="Identifier">parseChunkExtensions</span><span class="Punctuation">(</span><span class="StringLit">";a1=v1;a2=v2"</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">extensions</span><span class="Punctuation">[</span><span class="DecNumber">0</span><span class="Punctuation">]</span><span class="Operator">.</span><span class="Identifier">name</span> <span class="Operator">==</span> <span class="StringLit">"a1"</span>
<span class="Identifier">assert</span> <span class="Identifier">extensions</span><span class="Punctuation">[</span><span class="DecNumber">0</span><span class="Punctuation">]</span><span class="Operator">.</span><span class="Identifier">value</span> <span class="Operator">==</span> <span class="StringLit">"v1"</span>
<span class="Identifier">assert</span> <span class="Identifier">extensions</span><span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">]</span><span class="Operator">.</span><span class="Identifier">name</span> <span class="Operator">==</span> <span class="StringLit">"a2"</span>
<span class="Identifier">assert</span> <span class="Identifier">extensions</span><span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">]</span><span class="Operator">.</span><span class="Identifier">value</span> <span class="Operator">==</span> <span class="StringLit">"v2"</span></pre>
&nbsp;&nbsp;<a href="https://github.com/iocrate/netkit/tree/master/netkit/http/chunk.nim#L198" class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/iocrate/netkit/edit/devel/netkit/http/chunk.nim#L198" class="link-seesrc" target="_blank">Edit</a>

</dd>
<a id="parseChunkTrailers,openArray[string]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#parseChunkTrailers%2CopenArray%5Bstring%5D"><span class="Identifier">parseChunkTrailers</span></a><span class="Other">(</span><span class="Identifier">ts</span><span class="Other">:</span> <span class="Identifier">openArray</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <a href="headerfield.html#HeaderFields"><span class="Identifier">HeaderFields</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Converts a string array representing trailers to a <tt class="docutils literal"><span class="pre">HeaderFields</span></tt>.</p>
<p>Examples:</p>
<pre class="listing"><span class="Keyword">let</span> <span class="Identifier">fields</span> <span class="Operator">=</span> <span class="Identifier">parseChunkTrailers</span><span class="Punctuation">(</span><span class="Operator">@</span><span class="Punctuation">[</span><span class="StringLit">"Expires: Wed, 21 Oct 2015 07:28:00 GMT"</span><span class="Punctuation">]</span><span class="Punctuation">)</span>
           <span class="Comment"># =&gt; ("Expires", "Wed, 21 Oct 2015 07:28:00 GMT")</span>
<span class="Identifier">assert</span> <span class="Identifier">fields</span><span class="Punctuation">[</span><span class="StringLit">"Expires"</span><span class="Punctuation">]</span><span class="Punctuation">[</span><span class="DecNumber">0</span><span class="Punctuation">]</span> <span class="Operator">==</span> <span class="StringLit">"Wed, 21 Oct 2015 07:28:00 GMT"</span></pre>
&nbsp;&nbsp;<a href="https://github.com/iocrate/netkit/tree/master/netkit/http/chunk.nim#L211" class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/iocrate/netkit/edit/devel/netkit/http/chunk.nim#L211" class="link-seesrc" target="_blank">Edit</a>

</dd>
<a id="encodeChunk,pointer,pointer,Natural"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#encodeChunk%2Cpointer%2Cpointer%2CNatural"><span class="Identifier">encodeChunk</span></a><span class="Other">(</span><span class="Identifier">source</span><span class="Other">:</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">dest</span><span class="Other">:</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">size</span><span class="Other">:</span> <span class="Identifier">Natural</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Natural</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Encodes <tt class="docutils literal"><span class="pre">size</span></tt> bytes from the buffer <tt class="docutils literal"><span class="pre">source</span></tt>, storing the results in the buffer <tt class="docutils literal"><span class="pre">dest</span></tt>. The return value is the number of bytes of the results.</p>
<p><strong>Note:</strong> the length of <tt class="docutils literal"><span class="pre">dest</span></tt> must be at least <tt class="docutils literal"><span class="pre">21</span></tt> bytes larger than <tt class="docutils literal"><span class="pre">source</span></tt> to hold the results.</p>
<p>Examples:</p>
<pre class="listing"><span class="Keyword">let</span> <span class="Identifier">source</span> <span class="Operator">=</span> <span class="StringLit">"Developer"</span>
<span class="Keyword">let</span> <span class="Identifier">dest</span> <span class="Operator">=</span> <span class="Identifier">newString</span><span class="Punctuation">(</span><span class="Identifier">source</span><span class="Operator">.</span><span class="Identifier">len</span> <span class="Operator">+</span> <span class="DecNumber">21</span><span class="Punctuation">)</span>
<span class="Identifier">encodeChunk</span><span class="Punctuation">(</span><span class="Identifier">source</span><span class="Operator">.</span><span class="Identifier">cstring</span><span class="Punctuation">,</span> <span class="Identifier">source</span><span class="Operator">.</span><span class="Identifier">len</span><span class="Punctuation">,</span> <span class="Identifier">dest</span><span class="Operator">.</span><span class="Identifier">cstring</span><span class="Punctuation">,</span> <span class="Identifier">dest</span><span class="Operator">.</span><span class="Identifier">len</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">dest</span> <span class="Operator">==</span> <span class="StringLit">"9</span><span class="EscapeSequence">\r</span><span class="EscapeSequence">\n</span><span class="EscapeSequence">Developer\r</span><span class="EscapeSequence">\n</span><span class="StringLit">"</span></pre>
&nbsp;&nbsp;<a href="https://github.com/iocrate/netkit/tree/master/netkit/http/chunk.nim#L222" class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/iocrate/netkit/edit/devel/netkit/http/chunk.nim#L222" class="link-seesrc" target="_blank">Edit</a>

</dd>
<a id="encodeChunk,pointer,pointer,Natural,type openArray[ChunkExtension]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#encodeChunk%2Cpointer%2Cpointer%2CNatural%2Ctype+openArray%5BChunkExtension%5D"><span class="Identifier">encodeChunk</span></a><span class="Other">(</span><span class="Identifier">source</span><span class="Other">:</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">dest</span><span class="Other">:</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">size</span><span class="Other">:</span> <span class="Identifier">Natural</span><span class="Other">;</span>
                <span class="Identifier">extensions</span> <span class="Other">=</span> <span class="Identifier">openArray</span><span class="Other">[</span><a href="chunk.html#ChunkExtension"><span class="Identifier">ChunkExtension</span></a><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Natural</span></pre></dt>
<dd>

<p>Encodes <tt class="docutils literal"><span class="pre">size</span></tt> bytes from the buffer <tt class="docutils literal"><span class="pre">source</span></tt>, storing the results in the buffer <tt class="docutils literal"><span class="pre">dest</span></tt>. <tt class="docutils literal"><span class="pre">extensions</span></tt> specifies chunk extensions. The return value is the number of bytes of the results.</p>
<p><strong>Note:</strong> the length of <tt class="docutils literal"><span class="pre">dest</span></tt> must be at least <tt class="docutils literal"><span class="pre">21 + extensions.len</span></tt> bytes larger than <tt class="docutils literal"><span class="pre">source</span></tt> to hold the results.</p>
<p>Examples:</p>
<pre class="listing"><span class="Keyword">let</span> <span class="Identifier">source</span> <span class="Operator">=</span> <span class="StringLit">"Developer"</span>
<span class="Keyword">let</span> <span class="Identifier">extensions</span> <span class="Operator">=</span> <span class="StringLit">"language=en; city=London"</span>
<span class="Keyword">let</span> <span class="Identifier">dest</span> <span class="Operator">=</span> <span class="Identifier">newString</span><span class="Punctuation">(</span><span class="Identifier">source</span><span class="Operator">.</span><span class="Identifier">len</span> <span class="Operator">+</span> <span class="DecNumber">21</span> <span class="Operator">+</span> <span class="Identifier">extensions</span><span class="Operator">.</span><span class="Identifier">len</span><span class="Punctuation">)</span>
<span class="Identifier">encodeChunk</span><span class="Punctuation">(</span><span class="Identifier">source</span><span class="Operator">.</span><span class="Identifier">cstring</span><span class="Punctuation">,</span> <span class="Identifier">source</span><span class="Operator">.</span><span class="Identifier">len</span><span class="Punctuation">,</span> <span class="Identifier">dest</span><span class="Operator">.</span><span class="Identifier">cstring</span><span class="Punctuation">,</span> <span class="Identifier">dest</span><span class="Operator">.</span><span class="Identifier">len</span><span class="Punctuation">,</span> <span class="Identifier">extensions</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">dest</span> <span class="Operator">==</span> <span class="StringLit">"9; language=en; city=London</span><span class="EscapeSequence">\r</span><span class="EscapeSequence">\n</span><span class="EscapeSequence">Developer\r</span><span class="EscapeSequence">\n</span><span class="StringLit">"</span></pre>
&nbsp;&nbsp;<a href="https://github.com/iocrate/netkit/tree/master/netkit/http/chunk.nim#L241" class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/iocrate/netkit/edit/devel/netkit/http/chunk.nim#L241" class="link-seesrc" target="_blank">Edit</a>

</dd>
<a id="encodeChunk,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#encodeChunk%2Cstring"><span class="Identifier">encodeChunk</span></a><span class="Other">(</span><span class="Identifier">source</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Encodes <tt class="docutils literal"><span class="pre">source</span></tt> into a chunk.</p>
<p>Examples:</p>
<pre class="listing"><span class="Keyword">let</span> <span class="Identifier">dest</span> <span class="Operator">=</span> <span class="Identifier">encodeChunk</span><span class="Punctuation">(</span><span class="StringLit">"Developer"</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">dest</span> <span class="Operator">==</span> <span class="StringLit">"9</span><span class="EscapeSequence">\r</span><span class="EscapeSequence">\n</span><span class="EscapeSequence">Developer\r</span><span class="EscapeSequence">\n</span><span class="StringLit">"</span></pre>
&nbsp;&nbsp;<a href="https://github.com/iocrate/netkit/tree/master/netkit/http/chunk.nim#L263" class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/iocrate/netkit/edit/devel/netkit/http/chunk.nim#L263" class="link-seesrc" target="_blank">Edit</a>

</dd>
<a id="encodeChunk,string,openArray[ChunkExtension]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#encodeChunk%2Cstring%2CopenArray%5BChunkExtension%5D"><span class="Identifier">encodeChunk</span></a><span class="Other">(</span><span class="Identifier">source</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">extensions</span><span class="Other">:</span> <span class="Identifier">openArray</span><span class="Other">[</span><a href="chunk.html#ChunkExtension"><span class="Identifier">ChunkExtension</span></a><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Encodes <tt class="docutils literal"><span class="pre">source</span></tt> into a chunk. <tt class="docutils literal"><span class="pre">extensions</span></tt> specifies chunk extensions.</p>
<p>Examples:</p>
<pre class="listing"><span class="Keyword">let</span> <span class="Identifier">dest</span> <span class="Operator">=</span> <span class="Identifier">encodeChunk</span><span class="Punctuation">(</span><span class="StringLit">"Developer"</span><span class="Punctuation">,</span> <span class="Punctuation">{</span>
  <span class="StringLit">"language"</span><span class="Punctuation">:</span> <span class="StringLit">"en"</span><span class="Punctuation">,</span>
  <span class="StringLit">"city"</span><span class="Punctuation">:</span> <span class="StringLit">"London"</span>
<span class="Punctuation">}</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">dest</span> <span class="Operator">==</span> <span class="StringLit">"9; language=en; city=London</span><span class="EscapeSequence">\r</span><span class="EscapeSequence">\n</span><span class="EscapeSequence">Developer\r</span><span class="EscapeSequence">\n</span><span class="StringLit">"</span></pre>
&nbsp;&nbsp;<a href="https://github.com/iocrate/netkit/tree/master/netkit/http/chunk.nim#L273" class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/iocrate/netkit/edit/devel/netkit/http/chunk.nim#L273" class="link-seesrc" target="_blank">Edit</a>

</dd>
<a id="encodeChunkEnd"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#encodeChunkEnd"><span class="Identifier">encodeChunkEnd</span></a><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Returns a string consisting of a terminating chunk and a final CRLF sequence.</p>
<p>Examples:</p>
<pre class="listing"><span class="Keyword">let</span> <span class="Identifier">dest</span> <span class="Operator">=</span> <span class="Identifier">encodeChunkEnd</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">dest</span> <span class="Operator">==</span> <span class="StringLit">"0</span><span class="EscapeSequence">\r</span><span class="EscapeSequence">\n</span><span class="EscapeSequence">\r</span><span class="EscapeSequence">\n</span><span class="StringLit">"</span></pre>
&nbsp;&nbsp;<a href="https://github.com/iocrate/netkit/tree/master/netkit/http/chunk.nim#L286" class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/iocrate/netkit/edit/devel/netkit/http/chunk.nim#L286" class="link-seesrc" target="_blank">Edit</a>

</dd>
<a id="encodeChunkEnd,HeaderFields"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#encodeChunkEnd%2CHeaderFields"><span class="Identifier">encodeChunkEnd</span></a><span class="Other">(</span><span class="Identifier">trailers</span><span class="Other">:</span> <a href="headerfield.html#HeaderFields"><span class="Identifier">HeaderFields</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Returns a string consisting of a terminating chunk, trailer and a final CRLF sequence. <tt class="docutils literal"><span class="pre">trailers</span></tt> specifies the metadata carried.</p>
<p>Examples:</p>
<pre class="listing"><span class="Keyword">let</span> <span class="Identifier">dest</span> <span class="Operator">=</span> <span class="Identifier">encodeChunkEnd</span><span class="Punctuation">(</span><span class="Identifier">initHeaderFields</span><span class="Punctuation">(</span><span class="Punctuation">{</span>
  <span class="StringLit">"Expires"</span><span class="Punctuation">:</span> <span class="StringLit">"Wed, 21 Oct 2015 07:28:00 GM"</span>
<span class="Punctuation">}</span><span class="Punctuation">)</span><span class="Punctuation">)</span>
<span class="Identifier">assert</span> <span class="Identifier">dest</span> <span class="Operator">==</span> <span class="StringLit">"0</span><span class="EscapeSequence">\r</span><span class="EscapeSequence">\n</span><span class="EscapeSequence">Expires: Wed, 21 Oct 2015 07:28:00 GM\r</span><span class="EscapeSequence">\n</span><span class="EscapeSequence">\r</span><span class="EscapeSequence">\n</span><span class="StringLit">"</span></pre>
&nbsp;&nbsp;<a href="https://github.com/iocrate/netkit/tree/master/netkit/http/chunk.nim#L296" class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/iocrate/netkit/edit/devel/netkit/http/chunk.nim#L296" class="link-seesrc" target="_blank">Edit</a>

</dd>

</dl></div>

  </div>
</div>

    <div class="row">
      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br>
        <small style="color: var(--hint);">Made with Nim. Generated: 2020-04-28 04:13:17 UTC</small>
      </div>
    </div>
  </div>
</div>



</body></html>